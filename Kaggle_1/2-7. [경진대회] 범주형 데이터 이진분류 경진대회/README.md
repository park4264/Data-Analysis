# **Part II. 머신러닝 문제해결**








# **Chapter 7. [경진대회] 범주형 데이터 이진분류**
## Categorical Feature Encoding Challenge
### Binary classification, with every feature a categorical

![img](./img/2-6-1.png)

- [Kaggle Link](https://www.kaggle.com/competitions/cat-in-the-dat)



# 0. 경진대회 이해 💁🏻‍♂️

- **Goal**: 범주형 피처 23개를 활용해 해당 데이터가 타깃값 1에 속할 확률을 예측하는 것.

## 0-1. 특이점 세 가지

1. 인위적으로 만든 데이터를 제공
    - 대부분의 경진대회에서 제공하는 실제 데이터는 깔끔하게 정리되어 있지 않은 경우가 많아서, 연습용으로는 오히려 인공 데이터가 좋다.
    


2. 각 피처와 타깃값의 의미를 알 수 없다.
    - 인위로 만들 때 데이터에 아무런 의미를 부여하지 않았기 때문
    - 이런 경우 배경 지식을 활용하지 못함
    - 이번 경진대회는 순전히 데이터만 보고 접근해야 함


3. 제공되는 데이터는 모두 범주형
    - 값이 두 개로만 구성된 데이터는 순서형 데이터(ordinal data), 명목형 데이터(nominal data), 날짜 데이터까지 다양
    - `bin_`로 시작하는 피처는 이진 피처
    - `nom_`로 시작하는 피처는 명목형 피처
    - `ord_`로 시작하는 피처는 순서형 피처
    - `day`와 `month`는 날짜 피처
    - 또한, 순서형 피처 중 `ord_3`, `ord_4`, `ord_5`는 알파벳 순으로 고윳값 순서를 매김




</br>

- 타깃값도 범주형 데이터 `0, 1`
- 타깃값이 두 가지이므로 본 경진대회는 이진분류 문제
- 이 대회를 통해 범주형 데이터 인코딩 방법을 숙달할 수 있다.


</br>

> - 분류 문제에서는 주로 '1일 확률'을 예측 
> - 타깃값 자체를 확실하게 예측하기에는 어렵기 때문에 확률로 예측
> - 일반적으로 0은 음성, 1은 양성







    
# 1. 데이터 둘러보기📈📊


# 분석 정리 및 모델링 전략

## 1-1. 분석 정리

1. 결측값 없음
    
2. 모든 피처가 중요하여 제거할 피처를 찾지 못했습니다.

3. **이진 피처 인코딩**
    - 값이 숫자가 아닌 이진 피처는 `0`과 `1`로 인코딩합니다.

4. **명목형 피처 인코딩**
    - 전체 데이터가 크지 않으므로 모두 원-핫 인코딩합니다.

5. **순서형 피처 인코딩**
    - 고윳값들의 순서에 맞게 인코딩합니다.(이미 숫자로 되어 있다면 인코딩 필요 없음)

6. **날짜 피처 인코딩**
    - 값의 크고 작음으로 해석되지 못하도록 원-핫 인코딩합니다.



## 1-2. 모델링 전략

- 이번 프로젝트의 목표: 데이터의 특성에 따른 맞춤형 인코딩 방법 익히기
- 따라서 머신러닝 모델은 기본적인 로지스틱 회귀 모델을 계속 사용하면서 피처 엔지니어링에 집중할 것.
- ➕ 간단하게 이용할 수 있는 하이퍼파라미터 최적화 등의 성능 개선 팁

</br>

- **베이스라인 모델**: 로지스틱 회귀 모델
    - **피처 엔지니어링**: 모든 피처를 원-핫 인코딩


- **성능 개선**: 추가 피처 엔지니어링과 하이퍼파라미터 최적화
    - **피처 엔지니어링**: 피처 맞춤 인코딩과 피처 스케일링
    - **하이퍼파라미터 최정화**: 그리드서치


- **추가 팁**: 검증 데이터를 훈련에 사용




